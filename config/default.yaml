# Shield Core - Default Configuration
# Override via environment variables prefixed with SHIELD_

server:
  host: "127.0.0.1"
  port: 8080

database:
  url: "sqlite:shield.db?mode=rwc"

safety:
  # Maximum amount (in any currency) that can be auto-approved
  max_auto_amount: 100.0
  # Amount threshold requiring human-in-the-loop review
  hitl_threshold: 1000.0
  # Maximum transfers allowed per hour per user (rate limiting)
  max_transfers_per_hour: 3
  # Suspicious keywords for input firewall (prompt injection detection)
  suspicious_keywords:
    # Classic prompt injection
    - "ignore previous instructions"
    - "ignore all previous"
    - "disregard previous"
    - "forget your instructions"
    - "forget previous"
    # Jailbreak attempts  
    - "bypass"
    - "bypass all"
    - "bypass security"
    - "developer mode"
    - "DAN mode"
    - "jailbreak"
    # System prompt leakage
    - "print your system prompt"
    - "show your instructions"
    - "reveal your prompt"
    - "what are your rules"
    # Authority/privilege escalation
    - "admin command"
    - "execute command"
    - "override security"
    - "disregard rules"
    - "you are now"
    - "pretend you are"
    - "act as if"
    - "simulate being"
    # Dangerous operations
    - "transfer all funds"
    - "transfer all money"
    - "empty account"
    - "drain account"
    - "maximum transfer"
    - "all available balance"

# Authentication settings
auth:
  # Set to true to enable authentication (recommended for production)
  enabled: false
  
  # JWT secret - MUST be changed in production via SHIELD_AUTH__JWT_SECRET env var
  jwt_secret: "CHANGE_ME_IN_PRODUCTION_shield_jwt_secret_key_2024"
  jwt_issuer: "shield-core"
  token_duration_hours: 24
  
  # API keys for agent/LLM clients
  # In production, manage these via database or secrets manager
  api_keys:
    - id: "key-dev-001"
      # Default dev key - remove or rotate in production
      key: "sk-shield-dev-key-12345"
      name: "Development Agent"
      client_id: "dev-agent"
      rate_limit: 100
  
  # Admin console users
  # Password hashes are SHA256 hex. Generate with: echo -n "password" | shasum -a 256
  users:
    - id: "user-admin-001"
      email: "admin@shield.lat"
      # Default password: "shield2024" - CHANGE IN PRODUCTION
      # echo -n "shield2024" | shasum -a 256
      password_hash: "2ae2107409cfc29923bd8429b398786c5bf41ea4bb0eccd3c5b11af42ca3fba3"
      role: admin

# LLM integration settings (Llama Guard via OpenRouter)
llm:
  # Enable neural content safety using Llama Guard 4
  enabled: false
  # OpenRouter API key - set via SHIELD_LLM_OPENROUTER_API_KEY env var
  openrouter_api_key: ""
  # Model to use for content classification
  guard_model: "meta-llama/llama-guard-4-12b"
  # Request timeout in seconds
  timeout_secs: 10

